<section class="book-practitioner-dialog--content">
	<div class="book-practitioner-dialog--header center">
		<div class="book-back-practitioner">
			<a href="" ng-click="killBookWindow()"
				><svg width="12" height="20" viewBox="0 0 12 20" xmlns="http://www.w3.org/2000/svg">
					<title>Back</title>
					<path
						d="M2.058 9.93l9.674-8.575c.343-.343.343-.755 0-1.098-.343-.343-.892-.343-1.097 0L.412 9.245c-.206 0-.206.206-.206.206C0 9.658 0 9.795 0 10c0 .206 0 .343.206.55l.206.205 10.085 8.988c.343.343.892.343 1.098 0 .206-.343.343-.755 0-1.098L2.058 9.93z"
						fill="#111111"
						fill-rule="evenodd"
					/>
				</svg>
			</a>
		</div>
		<div class="book-practitioner-dialog--pracname clearfix">
			<div class="practitioner-photo photo-90">
				<img
					ng-if="practitioner.image_url"
					class="profile-photo"
					ng-src="{{ practitioner.image_url }}"
					alt="{{ practitioner.first_name }} {{ practitioner.last_name }}"
				/>
				<div ng-if="!practitioner.image_url" class="practitioner-noimg">
					<svg
						viewBox="0 0 80 80"
						fill="none"
						xmlns="http://www.w3.org/2000/svg"
						role="img"
					>
						<path d="M40 80c22.091 0 40-17.909 40-40S62.091 0 40 0 0 17.909 0 40s17.909 40 40 40z" fill="#DCE9E1" />
						<path
							d="M53.664 17.265a5.634 5.634 0 00-1.976.352 8.31 8.31 0 00-15.116-1.78 5.89 5.89 0 00-8.686 5.16c.002.53.077 1.056.222 1.566a6.463 6.463 0 00-2.313 11.392 5.43 5.43 0 002.337 9.884A2.894 2.894 0 1033.25 45.7a2.886 2.886 0 00-1.64-2.583 5.43 5.43 0 001.033-8.53 6.472 6.472 0 003.535-5.741c0-.792-.147-1.576-.435-2.313a5.74 5.74 0 001.715-.993 8.3 8.3 0 0011.482.952 5.781 5.781 0 104.659-9.203l.065-.024z"
							fill="#0E8671"
						/>
						<path
							d="M46.996 55.346c-4.757-.55-4.01-7.3-1.69-8.62 1.206-.69 4.102 1.468 6.907-.214 1.64-.984-.05-3.674.508-4.732a24.03 24.03 0 002.74-15.698c-2.15-14.116-20.817-13.345-25.049-3.716-3.715 8.432 2.608 18.495-2.255 32.176a11.244 11.244 0 01-1.64 3.059l12.606 6.504s8.931-8.637 7.873-8.76z"
							fill="#70B2A6"
						/>
						<path d="M55.46 29.469a42.422 42.422 0 001.436 6.947c-.608.307-1.302.4-1.969.262" fill="#70B2A6" />
						<path
							d="M55.46 29.469a42.422 42.422 0 001.436 6.947c-.608.307-1.302.4-1.969.262"
							stroke="#0E8671"
							strokeWidth="1.18"
							strokeLinecap="round"
							strokeLinejoin="round"
						/>
						<path d="M54.394 39.656a30.338 30.338 0 01-3.674-1.386h-.5a5.87 5.87 0 003.444 2.92l.73-1.534z" fill="#DCE9E1" />
						<path
							d="M50.088 38.105a.23.23 0 01.27-.098c1.056.297 2.145.455 3.24.467.878 0 1.206 0 1.42.304a.64.64 0 01-.558.951 8.045 8.045 0 01-4.323-1.32.238.238 0 01-.049-.304z"
							fill="#70B2A6"
						/>
						<path
							d="M50.088 38.278a8.875 8.875 0 001.764 3.026c1 1.124 1.87 1.165 2.214.615.344-.55-.156-.82-1.198-1.37a11.426 11.426 0 01-2.78-2.271z"
							fill="#70B2A6"
						/>
						<path
							d="M45.15 22.793a8.448 8.448 0 01-4.847 6.98c-.96.41-1.935.287-2.854.77-.918.484.115.96.05 1.928-.099 1.402-4.922 16.15-7.825 16.059 0 0-4.995-16.502-1.73-25.425.877-2.404 3.543-3.93 5.544-5.643 1.73-1.477 5.577-1.83 8.054-1.96 2.747-.124 3.699 5.06 3.609 7.29z"
							fill="#0E8671"
						/>
						<path
							d="M40.722 19.16c.566.483-.107 4.83.205 5.51.311.681-2.338 5.496-1.64 5.315 5.946-1.46 7.594-8.045 8.94-8.447 1.574-.468 2.337 1.246 2.41 1.861.075.616 0 1.23.075 1.846a4.24 4.24 0 002.698 3.338 3.78 3.78 0 003.92-1.074c-1.722-4.208-3.28-8.128-7.029-10.81-1.46-1.042-1.845-1.747-3.633-1.747-1.19 0-6.791-.763-7.53.155-1.254 1.6.747 3.347 1.584 4.052z"
							fill="#0E8671"
						/>
						<path d="M39.368 29.526a2.296 2.296 0 10-1 4.101" fill="#70B2A6" />
						<path
							d="M39.368 29.526a2.296 2.296 0 10-1 4.101"
							stroke="#0E8671"
							strokeWidth="1.18"
							strokeLinecap="round"
							strokeLinejoin="round"
						/>
						<path
							d="M56.297 57.257a56.468 56.468 0 00-9.219-1.583l-7.956 8.431-12.59-6.504a39 39 0 00-8.554 2.395"
							stroke="#70B2A6"
							strokeWidth="1.16"
							strokeLinecap="round"
							strokeLinejoin="round"
						/>
						<path
							d="M26.533 57.6l1.829 7.276a3.421 3.421 0 004.872 2.214l5.888-2.985 4.79 1.386a3.28 3.28 0 004.216-3.428l-.558-6.234M39.122 64.105l.402 3.592"
							stroke="#70B2A6"
							strokeWidth="1.16"
							strokeLinecap="round"
							strokeLinejoin="round"
						/>
					</svg>
				</div>
			</div>
			<div class="book-practitioner-name">
				<h5>{{ practitioner.profiles.practitioner.verticals[0] }}</h5>
				<h3>{{ practitioner.first_name }} {{ practitioner.last_name }}</h3>
			</div>
		</div>
	</div>

	<div class="book-practitioner-dialog--options center">
		<div ng-if="activeStep == 'selectTime' " class="book-step-select-time">
			<div class="book-select-time-header">
				<h2>{{ product.minutes }} minute video appointment</h2>
			</div>

			<div ng-if="instaBook">
				<h5>Next available appointment starts in {{ events[0].start | amDifference: null:"minutes" }} minutes</h5>
				<h3>{{ events[0].start | amDateFormat: "h:mm" }} - {{ events[0].end | amDateFormat: "h:mm a" }}</h3>
				<p><a class="btn btn-action" ng-click="selectTime(events[0])">Select</a></p>
			</div>

			<div ng-if="events && !instaBook" class="clearfix book-events">
				<h5>Choose a day and time</h5>
				<tien-clndr class="clndr" tien-clndr-object="clndr" tien-clndr-events="events" tien-clndr-options="options">
					<div class="clndr-grid">
						<div class="month">
							<h3>{{ month }}</h3>
						</div>
						<div class="days-of-the-week clearfix">
							<div
								class="header-day"
								ng-repeat="day in daysOfTheWeek track by $index"
								ng-class="{ 'selected-day' : selectedDay === day}"
							>
								<h5>{{ day }}</h5>
							</div>
						</div>
						<div class="days clearfix">
							<div
								class="{{ day.classes }}"
								ng-repeat="day in days"
								ng-click="selectDay(day)"
								ng-class="{ 'selected-day' : selectedDay === day}"
								ng-attr-tabindex="{{ day.classes.indexOf('event') < 0 ? -1 : 0 }}"
							>
								<h3>{{ day.day }}</h3>
								<em class="selected-day-flag"></em>
							</div>
						</div>
					</div>
				</tien-clndr>
			</div>

			<div ng-if="timeSlots" class="booking-select-time">
				<ul class="clear book-time-slots">
					<li ng-repeat="(key, slots) in timeSlots" class="time-slots">
						<ul class="clear center clearfix">
							<h5>{{ key }}</h5>
							<li ng-repeat="t in slots track by $index">
								<span ng-click="selectTime(t)"
									>{{ t.start | amDateFormat: "h:mm" }} - {{ t.end | amDateFormat: "h:mm a" }}</span
								>
							</li>
						</ul>
					</li>
				</ul>
			</div>
		</div>

		<div ng-if="activeStep == 'addCard' || activeStep == 'bookingConfirm' ">
			<div class="book-time-review-header">
				<div class="book-back-time">
					<a href="" ng-click="refreshTimes()">
						<svg width="12" height="20" viewBox="0 0 12 20" xmlns="http://www.w3.org/2000/svg">
							<title>Back</title>
							<path
								d="M2.058 9.93l9.674-8.575c.343-.343.343-.755 0-1.098-.343-.343-.892-.343-1.097 0L.412 9.245c-.206 0-.206.206-.206.206C0 9.658 0 9.795 0 10c0 .206 0 .343.206.55l.206.205 10.085 8.988c.343.343.892.343 1.098 0 .206-.343.343-.755 0-1.098L2.058 9.93z"
								fill="#111111"
								fill-rule="evenodd"
							/>
						</svg>
					</a>
				</div>

				<div class="book-time-review">
					<h5>{{ product.minutes }} minute video appointment</h5>
					<h3>
						{{ selected_time | amDateFormat: "dddd, MMMM D" }}<br />{{ selected_time | amDateFormat: "h:mm" }} - {{
						selected_end | amDateFormat: " h:mma" }}
					</h3>
				</div>
			</div>

			<div ng-if="activeStep == 'addCard' " class="add-card">
				<h2 ng-if="!user.organization">
					Total cost: <span ng-if="availCredits < 1">{{ product.price | currency: "$":0 }}</span
					><span ng-if="availCredits  >=1"
						><span class="discounted-price">{{ product.price | currency: "$":0 }}</span> {{ product.price - availCredits
						| minzero | currency: "$":0 }} using credits</span
					>
				</h2>
				<h5>Add a card for payment</h5>
				<p>You won't be charged until your appointment is completed</p>

				<form ng-if="!hasPaymentMethod" name="addCardForm" stripe-form="stripeProcess" role="form" class="mvn-form">
					<section ng-if="errorMsg" class="form-section">
						<div class="form-errors">
							<p>
								<span class="error-icon"
									><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 200 200">
										<path
											fill="#FF7774"
											d="M100.9 13c-47.5 0-86.3 38.8-86.3 86.3s38.9 86.3 86.3 86.3 86.3-38.9 86.3-86.3c.1-47.5-38.8-86.3-86.3-86.3zm2.2 139.4c-5.8 0-10.7-4.9-10.7-10.7 0-5.9 4.9-10.9 10.7-10.9 5.9 0 10.9 5 10.9 10.9-.1 5.8-5 10.7-10.9 10.7zm12.4-77.9l-6.8 39c-.1 1.1-1.4 2.2-2.6 2.2h-5.8c-1.2 0-2.5-1.1-2.6-2.2l-6.8-38.7V58.9v-.1c0-.1-.1-.2-.1-.3 0-6.8 5.5-12.3 12.3-12.3 6.8 0 12.3 5.5 12.3 12.3v.2c0 .1.1.1.1.2v15.6z"
										/>
									</svg>
								</span>
								{{ err }}
							</p>
						</div>
					</section>
					<section class="form-section">
						<div class="form-elements-container w-100">
							<div class="mvn-input" ng-class="{ 'has-content': addCardForm.number.$viewValue }">
								<input
									class="mvn-form-input payments-card-number"
									name="number"
									type="text"
									ng-model="number"
									payments-format="card"
									payments-type-model="type"
									minlength="16"
									required
								/>
								<label class="mvn-form-label">Card number</label>
							</div>

							<div class="mvn-input" ng-class="{ 'has-content': addCardForm.expiry.$viewValue }">
								<input
									class="mvn-form-input payments-card-expiry"
									name="expiry"
									type="text"
									ng-model="expiry"
									minlength="6"
									payments-format="expiry"
									required
								/>
								<label class="mvn-form-label">Expiry (MM/YYYY)</label>
							</div>
							<div class="mvn-input" ng-class="{ 'has-content': addCardForm.cvc.$viewValue }">
								<input
									class="mvn-form-input payments-card-cvc"
									name="cvc"
									type="text"
									ng-model="cvc"
									minlength="3"
									payments-type-model="type"
									payments-format="cvc"
									required
								/>
								<label class="mvn-form-label">CVC</label>
							</div>
							<button type="submit" class="btn btn-cta" ng-class="{ 'disabled' :  addCardForm.$invalid }">
								Add card
							</button>
						</div>
					</section>
				</form>
				<div class="book-enter-referral-code">
					<h5 ng-if="!showCodeField">
						<a ng-click="toggleAddReferralCode()" href="">I have a referral code</a>
					</h5>
					<div ng-if="showCodeField">
						<label>Enter your code</label>
						<form name="refCodeForm" class="paper-form">
							<div class="form-group">
								<paper-input
									class="paper-input add-referral-code"
									type="text"
									model-ref="refCode.referral_code"
									required=""
									value="CODE"
								></paper-input>
							</div>
							<p class="add-code">
								<a
									class="btn btn-tertiary"
									href="#"
									ng-click="addReferralCode(refCode.referral_code)"
									ng-class="{disabled: refCodeForm.$invalid }"
									>Apply code</a
								>
							</p>
						</form>
					</div>
				</div>
			</div>

			<div ng-if="activeStep == 'bookingConfirm' " class="booking-confirm">
				<h5 ng-if="!user.organization && !user.subscription_plans">
					Total cost: <span ng-if="availCredits < 1">{{ product.price | currency: "$":0 }}</span
					><span ng-if="availCredits >=1"
						><span class="discounted-price">{{ product.price | currency: "$":0 }}</span> {{ product.price - availCredits
						| minzero | currency: "$":0 }} using credits</span
					>
				</h5>
				<p ng-if="deviceOS !== 'ios' " class="mobile-only booking-mobile-alert">
					You'll need to use Chrome or Firefox on a PC or Mac in order to have your appointment, or if you're on
					iPhone/iPad, <a href="http://m.onelink.me/f569d662" target="_blank" href="#">download the app</a>.
				</p>
				<br />
				<p class="book-confirm">
					<a
						href=""
						class="btn btn-cta book-confirm-button"
						ng-click="bookAppointment()"
						ng-class="{ disabled: bookInProgress }"
						><span ng-hide="bookInProgress">Confirm &amp; book</span
						><span ng-show="bookInProgress">Please wait...</span></a
					>
				</p>
				<p class="p-xs">
					By booking this appointment you are agreeing to
					<span ng-if="!isEnterprise"
						>abide by the Maven Practitioner's
						<a ng-click="openDialog('practitionerCancellationPolicy.html')" href="#">cancellation policy</a>, </span
					>Maven's
					<a ng-click="openDialog('/js/mvnApp/public/ios-app/terms-of-service/index.html')" href="#">Terms of Service</a
					>, and
					<a ng-click="openDialog('/js/mvnApp/public/ios-app/consent-to-care-via-telehealth/index.html')" href="#">
						Consent to Care via Telehealth </a
					>.
				</p>
			</div>
		</div>
	</div>
</section>

<script type="text/ng-template" id="practitionerCancellationPolicy.html">
	<div class="center">
		<h3>Practitioner cancellation policy</h3><p>{{ practitioner.first_name }} {{ practitioner.last_name }}'s cancellation policy is <strong>{{ cancellationPolicy }}</strong></p>
	</div>
</script>
